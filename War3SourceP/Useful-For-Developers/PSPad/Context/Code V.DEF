;; PSPad code template for Code V
;; Author: Francois RIGUET 
;; Update: 06.2008 (release 9.82)
[Macro definition]
;; definition for functions
%varformat%=@C Variable format,,NUM,NUM;STR;IMG,
%vartype%=@C Variable type,,LCL,GBL;LCL,
%var%=@E, Variable name,^,i
%lbl%=@E, Label name,,label
%func%=@E, Function name,,func
%retexpr%=@E, Returned expression,,^x
%ffo%=@E First focus pos.,,-0.1
%nfo%=@E Nb of focus pos.,,5
%ifo%=@E Focus increment,,0.05
%defocusnumber%=@E Defocus number,,1
%numinputpts%=@E Number of points,,
%inputcoord%=@E Input array coords,,^
%inputwts%=@E Input array weights,,^
%numquadpts%=@E Nb of quadrature pts,,
%quadcoord%=@E Output array coords,,^
%quadwts%=@E Output array weights,,^
%expression1%=@E Expression 1,,^
%expression2%=@E Expression 2,,^
%numpointsz%=@E Number of points,,
%xarrz%=@E X coords array,,^
%yarrz%=@E Y coords array,,^
%farrz%=@E F(X,Y) array,,^
%numtermsz%=@E Nb Zernike terms,,  
%coefsz%=@E Output array,,^
%surfacenum%=@E Surface number,,1
%zoompos%=@E Zoom position,,1
%minheight%=@E Min height,,0
%maxheight%=@E Max height,,(MAP S)
%fieldnum%=@E Field number,,1
%wavenum%=@E Wavelength number,,1
%inputarray%=@E Input array,,^
%outputgb%=@C Output,,AINC,AINC;BANG;BPNG;BSDX;BSDY;CEFF;PANG;PROP;RDCL;RDCM;RDCN;SDPX;SDPY;SURN;SURX;SURY;SURZ;WCUX;WCUY;WDSX;WDSY;WSDX;WSDY,'
%x%=@E X coordinate,,
%y%=@E Y coordinate,,
%z%=@E Z coordinate,,
%poltypeevalz%=@C Polarization type,,0,0;1;2;3;4;5,
%outputevalz%=@C Output type,,INTENSITY,INTENSITY;PHASE,'
%zerniketype%=@C Zernike type,,ZFR,ZFR;ZRN,'
%glassnum%=@C NSS glass number,,1,1;2,
%frequency%=@E Spatial frequency,,
%azimuth%=@E Bar orientation (°),,0
%nrd%=@E Number of rays,,0
%outputarray%=@E Output array,,^
%diforgeo%=@C Computation type,,DIF,DIF;GEO,'
%sinorsqw%=@C Response type,,SIN,SIN;SQW,'
%apercheck%=@C Check aperture,,0,0;1,
%refsurf%=@E Reference surface,,0
%xtan%=@E X on S1 tangent plane,,
%ytan%=@E Y on S1 tangent plane,,
%xdirtan%=@E OBJ space X dir. tangent,,
%ydirtan%=@E OBJ space Y dir. tangent,,
%focus%=@C Focus type,,BES,BES;NOM,'
%curvature%=@E Ref. sphere curvature,,
%xinputarray%=@E X input array,,^
%yinputarray%=@E Y input array,,^
%A%=@E A matrix,,^
%arows%=@E A number of rows,,
%acols%=@E A number of columns,,
%U%=@E U orthogonal matrix,,^
%V%=@E V orthogonal matrix,,^
%S%=@E S singular val. matrix,,^
%xfld%=@E X field,,
%yfld%=@E Y field,,
%geoorstokes%=@C GEO(0)/STOKES(1),,0,0;1,
%gridscalefact%=@E Grid scale factor,,
%polinput%=@E Input polarization array,,^
%refsurface%=@E Reference surface,,1
%transdata%=@E Transform array,,^
%zcoefnum%=@E Zernike coefficient,,
%numterms%=@E Zernike terms number,,0
%pupilcoordtype%=@C Pupil type,,ENP,ENP;EXP;EXS,'
%numrows%=@E Number of rows,,
%numcols%=@E Number of columns,,
%bufnum%=@E Buffer number,,
%startrow%=@E Start row,,
%endrow%=@E End row,,
%startcol%=@E Start column,,
%endcol%=@E End column,,
%dcomp%=@C FFT dimension,,1D,1D;2D,
%tcomp%=@C Data type,,C,C,
%scomp%=@C Data format,,A,A;B,
%cenin%=@C Input origin,,CEN,CEN;UL,"
%cenout%=@C Output origin,,CEN,CEN;UL,"
%fdata%=@C I/O array or buffer,,^
%fwd%=@C FFT direction,,1,0;1,
%comp%=@E Complex numbers array,,^
%mag%=@E Magnitudes array,,^
%nummags%=@E Nb of mag. created,,
%imag%=@E Imaginary nbs array,,^
%numimags%=@E Nb of imag. created,,
%real%=@E Real numbers array,,^
%numreals%=@E Nb of reals created,,
%numrealsconv%=@E Nb of reals converted,,
%scale%=@E Scale factor,,
%numvals%=@E Nb of values in array,,
%stringexpr1%=@E String expr. 1,,
%stringexpr2%=@E String expr. 2,,
%stringexpression%=@E String expression,,
%substringexpr%=@E Sub-string expression,,
%numexpression%=@E Number expression,,
%rfexpression%=@E Replacement field expr.,,
%begexpr%=@E Begin number,,
%lengthexpr%=@E Length number,, 
%errormsg%=@E Error message,,,,"
%contline%=@E Continuous line,,0
%fctname%=@E Function name (no @),,,,"
%varname%=@E Variable name (no ^),,,,"
%asbuilttype%=@C Output type,,NOM,NOM;MEA;SIG;S2C;S2V,'
%01prvwvl%=@K Define wavelength ?,PWL,
%02prvwavelengths%=@E Wavelengths,,
%03prvglassname%=@E Glass name (no quotes),,,,'
%04prvmlt%=@K Melt fit ?,MLT,
%05prvrefglass%=@E Ref glass for melt fit,,,
%06prvdispersiontype%=@C Dispersion type,,,GMS;LAU;GML;GMS;SLM;CAU;HAR,
%07prvindicesorcoefs%=@E Indices or coefs,,,
%1project%=@E Project name ?,,
%2comment%=@E Comment ?,,
%color%=@C Color ?,,RED,RED;GRE;BLU;MAG;YEL;CYA;PIN;WHI;GRA;CHA;BLA;RUS;CHI;FOR;BAB;ROY,
%01pthfile%=@C File type,,SEQ,INT;LEN;SEQ,
%02pthmode%=@C Mode,,APP,APP;DEL;PRE,
%03pthpath%=@E Path(s),,
%01opetype%=@C Open mode,,NEW,APP;NEW;OLD,
%02opevariable%=@E Variable name,,data
%03opefilename%=@E File name,,
%04fileext%=@E File extension,,txt
%fieldtype%=@C Field type,,,OBJ;IMG;RIH;ANG,'
%spoerrornrd%=@E Error (<1) or NRD (>1),,0.01
%spotref%=@C Spot size ref. location,,DEF,CEN;CRA;DEF;MSC;USR,"
%spotxoffset%=@E X offset from chief ray (USR),,0
%spotyoffset%=@E Y offset from chief ray (USR),,0
%cvmacro%=@C Code V macro,,,abbe;aberrationgenerator;achromat;apset;archerprv;aut_Gauss_polgrid;aut_grid_ret;aut_grid_ret_fct;aut_polgrid_fct;autogrid;autogridgq;bauschprv;beacef1;beamplot;beamread;bendaber;bendback;bendfr;besseldef;bflplot;biconvex;binfab;birmat;bufdel;bump;catalog;cef_vs_focus;cef_vs_wl;ceferrf;chinaplot;chinaplot1;cirplt;closeplt;colorplt;cone;cradj;cradjfz;csetbbox;cvcurvaturex;cvevalexpr;cvevalexpr2;cvnewlens;cvquickrim;cvsetfield;cvsetfldtype;cvtfield;cvtpolar;cvtpupil;cvzoomfield;database;datacomm;datamake;db_convert;defleng;defmaxb;deldecenter;delta;dist;dndtcalc;docflat;doe2dplt;doeffic;doeparm;doesag;doeset;doeslice;dove;drawplt;drtab;edgvig;ellipse;epjtab;epstab;exstndef;extlen;f1hybrid;fft2dmtf;fiber;fibercld;fibersca;fifthdef;findkey;fl;flgint;flnint;flplot;fooape;foopoly;forder;forder1;fpeak;frameplt;frank3;rank4;frank5;gauss_apod_sine;ghost_view;ghostdef;glabplt;glassfit;GRIN_Couple;GRIN_fiber;GRIN_fiber1;hcodefs;hcodoub;hcoeffic;hcoefplt;hcomask;hcophtab;hcoplot;hcortoxy;hcosampl;hcoscan1;hcoscan2;hcoscaut;hcoscvie;hcosym;hcouvsin;hcovar;hcowleff;hcoxytor;helplt;hermitedef;hikariprv;histplt2;hoephase;ijtab;ilfooget;ilgrdbuf;ilintfil;ilrefsph;ilrevers;iltraget;initplt;input;input_fiber_apod;inswl;irreg_polygon_ape;isodefs;isoplot;isoplot1;jmctab;jmtab;jvec;labelplt;latcolor;ldirplt;lenstable;list;listdec;loopdem1;loopdem2;loopdem3;loophelp;loopinit;looplay;loopopt;looptext;loopvcom;loopview;loopzoom;loopzrim;lsizplt;lumspot;luneberg;macro;macrolib;makefave;makeglbs;makesamp;minspherical;mmctab;mmtab;montecar;moveplt;mtfdet;mtfdof;mtftab;mtfvsfld;mul2coa;MultiMode_Couple;MultiMode_Fiber;MultiMode_Fiber1;multiplt;nodp;nodpadj;ntsf;ofexport;oraplt;osacrystalprv;par_Bossung;par_resist_profile;pardst;parfc;partest;patent;pave_mm;pave_sv;pechan;pechan1;pechan2;penta;perturb;pilkingtonprv;plasticprv;plot_gl;plotwl;plusplt;pmctab;pmtab;polar;poldsp;polyape;polypipe;porro;prolith;prvpl;psfdef;psfplot;psfsize;PupAvg_Stokes_FWZ;pvtab;quickauto;quickview;rdrawplt;readline;readtest;rectplt;refcheck;reflimit;refrays;revers;rmin;rmoveplt;rsiview;rtang;samplt;scaleplt;search;setafocal;setfocalsurface;setvig;setxyan;setxyim;setxyob;skipline;spcfld;specmat;sphist;spline;spot2d;spotdet;sptab;stackplots;startplt;sumitaprv;sur;surc;svec;symbplt;tesglass;therm_env;therm_n;thermpik;tolchng;tolcomp;tolenc;toleranc;tolfdif;tolhelp;tollist;tolmonte;tolplot;tolspot;udg_radx_930;udi_aperture_930;uds_dmd_930;uds_flyseye_930;uds_sinusoid_930;uds_winstoncpc_930;uds_xto20_930;udsfit;udsfresn;umicoreprv;unvig;unwrap;usergrn;userhoe;userhoe2;userint;usersur;usersur1;usersur2;usersur3;userusp;utolchng;vp_data;vp_plot;vsave;yyb;yybar;yybconv;yybhelp;yybnew;yybplot;yybread;yybsave;yybsetup;yybspc;zcir;zemaxtocv;zli,

;; definition for options
%aliint%=@E INT file name,,
%beawrx%=@E X beam half width,,
%beawry%=@E Y beam half width,,
%01bionel%=@E Number of elevation,,21
%02bioofs%=@E Elevation offset (°),,0
%03biouni%=@C Display units,,LNS,AMI;ASE;LNS;MCR;MIC;MIL;MLR,
%01camncs%=@E Cam steps,,200
%02camlla%=@E Parameter label,,,,'
%cefmpr%=@C Mode profile,,GAU,FIL;GAU;STE,
%cefr%=@E Radius or file,,
%cefn%=@E Delta n or file radius,,
%cefa%=@E File angle,,
%01cosbld%=@E Block diameter,,300
%02cossep%=@E Edge to edge gap,,0.8
%03cosste%=@E Max steepness (°),,160
%04cosmax%=@E Max number of elements,,100
%05cosedg%=@E Edge increment,,1
%06cosdth%=@E Thickness increment,,1.5
%cxptyp%=@C Export format,,STEP,IGES;SAT;STEP,
%cxpfil%=@E File name,,
%elenot1%=@E Note 1,,All dimensions in mm,,'
%elenot2%=@E Note 2,,,,'
%elenot3%=@E Note 3,,,,'
%elenot4%=@E Note 4,,,,'
%1envtem%=@E Temperature,,20
%2envexp%=@K Mount / Spacer ?,EXP,
%3envmat%=@C Material,,,AL1100;AL2024;AL6061;AL7075;ALUMINA;BECU172;BEI70A;BEI220;BEI400;BEO;BES200F;BRASSC;BRASSF;CERVIT;CORDIERITE;CR39;CU101;CU102;DUCTILE;EPOXY;FS7940;FSAMERSIL;GRANITE;GREPOXY;INVAR35;INVAR36;KOVAR;LEXAN;MEGE30;MGAZ31BF;MGM1A;MMGRAL;MOLYLCG;MOLYTZM;NYLON;PLEXI;SIC;SINVAR;SS303;SS304;SS316;SS416;SS430;SS440;STEEL1015;STYRENE;SXA20;SXA30;SXA40;T400;TBB;TI;TI6AL4V;TSINVAR;TSTEEL;ULE;ZERODUR,
%4envpre%=@K Pressure ?,PRE,
%5envgas%=@C Gas,,,ARGON;ETHANE;HELIUM;HYDROG;MTHANE;NITROG;OXYGEN,
%6envmmhg%=@E Pressure (mm Hg),,
%01fabsag%=@K Compute asphere sag,SAG S,
%02fabbes%=@K Best sphere fit,BES,
%03fabsagsurf%=@E Asphere surface,,
%04fabspa%=@K Spacer table,SPA,
%05fabgsc%=@K Global ref. table,GSC,
%06fabdis%=@K Display interferogram,DIS,
%07fabint%=@K Interferogram fringes,INT,
%08fabintfile%=@E INT file,
%fielsa%=@K Spherical aberration,LSA,
%fieastchr%=@K Astigmatism chrom.,AST CHR,
%fiedstchr%=@K Distorsion chrom.,DST CHR,
%fma01maptype%=@C Map type,,DST,AST;BDE;CCD;CTD;DSC;DST;RSD;RWE;WPO;MTF;MTQ;GMT;GMQ,
%fma02frequency%=@E Frequecy for MTF ?,,
%fma03fieldtype%=@C Field type,,IMG,OBJ;IMG;RIH;ANG;AZE,
%fma04circularfield%=@K Circular field ?,CIR,
%foonrd%=@E Number of rays,,11
%foobou%=@C Draw boundary,,Y,N;Y,
%foodap%=@K Draw aperture,DAP,
%01fovssi%=@E Scale,,1
%02fovlis%=@K List rays ?,LIS
%gdenrd%=@E Number of rays,,20
%ghofsurf%=@E First surface,,1
%gholsurf%=@E Last surface,,i-1
%gldtype%=@C Data to list,,GPR,GLI;GPT;MLI;REL;TLI,
%gldcat%=@C Glass catalog,,,CHANCE;CHINA;CORNFR;CORNING;HIKARI;HOYA;KODAK;NSG;OHARA;PILKINGTON;SCHOTT;SPECIAL;SUMITA,
%gldglass%@E Glass name,,
%libtype%=@C File type,,*,*;LEN;SEQ;INT;LIS;PLT;MUL;TXT;DAT,
%libdir%=@K List directory ?,DIR
%libdirectory%=@E Directory,,
%libpur%=@K Purge old versions ?,PUR
%ltename%=@E File name,,
%lum01sha%=@C Source shape,,PNT,CYL;ELL;INF;PNT;REC;SPH,
%lum02shadim%=@E Source full dimensions,,20 20
%lum11src%=@K Source position ?,SRC,
%lum12rap%=@K Radiance profile ?,RAP, 
%lum15anp%=@K Angular profile ?,ANP,
%lum03rcv%=@E Receiver dimensions,,10 10
%lum04rcg%=@E Receiver grid,,100 100
%lum07dis%=@K Display ?,DIS,DIS
%lum09pro%=@K Profile ?,PRO,
%lum05nra%=@E Number of rays,,10000
%lum08rel%=@K Relative ?,REL,REL,
%lum10clr%=@K Clear results ?,CLR,
%lum06sym%=@C Symetry type,,NON,NON;QUA;ROT;XZ;YZ,
%lum13raptype%=@C Radiance type,,,FIL;GAU;UNI,
%lum16anptype%=@C Angular type,,,COS;FIL;GAU;LAM;UNI
%lum14rapfil%=@E Radiance file and scale,,,
%lum17anpfil%=@E Angular file and scale,,,
%01lsflis%=@K List points ?,LIS
%02lsftgr%=@E Transform grid,,128
%mtffoc%=@K Through focus plot ?,PLO FOC; FRE,
%mtffre%=@E Spatial frequency,,
%1multit%=@E Title,,
%2mulpht%=@C Physical thickness ?,,Y,Y;N,
%3mulres%=@K Restore file ?,RES
%4mulfres%=@E File to restore,,
%5mulsav%=@K Save file ?,SAV
%6mulfsav%=@E File to save in,,
%narsurf%=@E Cold stop surface,,1
%parrna%=@E Partial coherence factor,,0.5
%parbarnum%=@E Number of bars,,5
%parbarwidth%=@E Bar width,,0.005
%1pmalis%=@C List data,,N,Y;N,
%2pmaplo%=@C Plot wavefront,,N,Y;N,
%3pmadis%=@C Display wavefront,,Y,Y;N,
%4pmazernike%=@C Zernike decomposition,,,ZFR;ZRN,
%5pmaznumterms%=@E Zernike terms number,,
%1psflis%=@C List data,,N,Y;N,
%2psfplo%=@C Plot PSF,,N,Y;N,
%3psfdis%=@C Display PSF,,Y,Y;N,
%radcoo%=@K Circle centers coords.,COO
%rimwfr%=@K OPD curves,WFR,1
%01spebla%=@E Black body temperature,,3000
%02speresponse%=@C Spectral response #1,,P_1,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%03spersp%=@K Response #2 ?,RSP
%05spersp%=@K Response #3 ?,RSP
%07spersp%=@K Response #4 ?,RSP
%09spersp%=@K Response #5 ?,RSP
%11spersp%=@K Response #6 ?,RSP
%13spersp%=@K Response #7 ?,RSP
%15spersp%=@K Response #8 ?,RSP
%17spersp%=@K Response #9 ?,RSP
%19spersp%=@K Response #10 ?,RSP
%04speresponse%=@C Spectral response #2,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%06speresponse%=@C Spectral response #3,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%08speresponse%=@C Spectral response #4,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%10speresponse%=@C Spectral response #5,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%12speresponse%=@C Spectral response #6,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%14speresponse%=@C Spectral response #7,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%16speresponse%=@C Spectral response #8,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%18speresponse%=@C Spectral response #9,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%20speresponse%=@C Spectral response #10,,,P_1;P_11;P_16;P_20;P_24;S_1;S_20EX;RCA_I;RCA_II;RCA_III;RCA_IV;RCA_V;RCA_VI;RCA_VII;EARTH;EYE;PHOTOPIC;SCOTOPIC;WRA_2A;WRA_2B;WRA_2C;WRA_2E;WRA_3;WRA_4;WRA_8;WRA_9;WRA_12;WRA_15;WRA_16;WRA_21;WRA_22;WRA_23A;WRA_24;WRA_25;WRA_26;WRA_29,
%01sponrd%=@E Number of rays,,20
%02spopat%=@C Ray pattern,,GRD,CIR;GRD;SOB,
%03spoair%=@K Display Airy disk ?,AIR
%04spoannspo%=@C 100% spot annotation,,n,n;y, 
%05spoannrms%=@C RMS spot annotation,,n,n;y,
%06sportl%=@E Error for RMS (<1) or NRD (>1),,0.01
%07sportlnrd%=@K Use NRD for spot computation ?,NRD
%tesplaseq%=@E Test plate list (.seq),,
%1sssx%=@E X lamp position,,0
%1sssy%=@E Y lamp position,,0
%3sssusr%=@E Surface number,S,1
%4ssscha%=@E Channel number,,1
%5sssxdec%=@E Channel X decenter,,0
%6sssydec%=@E Channel Y decenter,,0
%7ssssim%=@E Polynomial order,,3
%8sssplo%=@K Plot ?,PLO
%tesstrategy%=@C Fitting strategy,,GAP,FUR;GAP;NEA;POW;STC,
%toduni%=@C Distortion unit,,LNS,AMI;ASE;LNS;MCR;MLR;MIC;MIL,
%1toltab%=@C Output table 1,,FIR,CEN;DEC;DEF;DER;FIR;IRR;THI;THR,
%2toltab%=@C Output table 2,,,CEN;DEC;DEF;DER;FIR;IRR;THI;THR,
%3toltab%=@C Output table 3,,,CEN;DEC;DEF;DER;FIR;IRR;THI;THR,
%4tolfunc%=@C Functions,,,AVE;INV;MON;PER;SNA;SNS;TAB,
%5tolperf%=@C Performance INV/MON/SNS,,,IMA;EFL;EP;OBJ;TT;RED; ;SA;COM;ASS;AST;DST;AX;LAT;XFO;YFO; ;RSA;RCO;RAS;RFC;RFI;RMA;RMF; ;DDI;DDT;DDR;DCO;DAS;DTI;DRC;DRA;DRN;DFT;DFN; ;AXI;EDG;EDF,
%1tortype%=@C Tolerancing type,,SNS,INV;SNS,
%2torfre%=@K MTF tolerancing ?,FRE
%3torfreq%=@E Spatial frequency,,
%1ugrtit%=@E Title,,,,'
%2ugrtype%=@C Plot type,,DTB,PNT;LIN;SPL; ;DTB;BIM;SFP;VIS,
%01v3dsur%=@E Surface range,,a
%02v3dcab%=@K Clear obscured rays ?,CAB
%03v3dfan%=@C Fan of rays ?,,,"FAN XZ";"FAN YZ",
%04v3dfannumber%=@E Number of rays (for fan),
%05v3dgrd%=@C Grid of rays ?,,,"GRD REC";"GRD POL",
%06v3dgrdx%=@E Number of X rays/rings (for grid),
%07v3dgrdy%=@E Number of Y rays/spokes (for grid),
%01viesur%=@E Surface range,,a
%02viefan%=@K Fan of rays ?,FAN
%03viecab%=@K Clear obscured rays ?,CAB
%04vienbr%=@C Surface / element number ?,,,"NBR SUR";"NBR ELE",
%05viedum%=@K Dummy surfaces ?,DUM
%06vielco%=@K Local coordinates ?,LCO
%wavnom%=@K Nominal focus ?,NOM
%wavrfo%=@K Refocus ?,RFO
%01imsobj%=@E Object file,,
%02imsfco%=@C Field coord type,,OBJ,OBJ;IMG;RIH;ANG,
%03imsobh%=@K Object height ?,OBH 
%04imsobhval%=@E Object height value,,
%05imsxof%=@E X object offset,,0
%06imsyof%=@E Y object offset,,0
%07imsazi%=@E Object rotation,,0
%08imstgr%=@E Transform grid,,128
%09imspmx%=@E X samples,,5
%10imspmy%=@E Y samples,,5
%11imssym%=@C Symmetry,,NON,NON;ROT, 
%12imscme%=@C Computation method,,PIS,PIS;RGB;COL,
%13imssvi%=@K Save image ?,SVI
%14imssvityp%=@C Image type ?,,,BMP;JPG;PNG,
%15imssvicol%=@C Color/Greyscale ?,,,COL;GRY,

;; definition for image functions
%imageA%=@E, Image A,,^
%imageB%=@E, Image B,,^
%inputimage%=@E, Intput image,,^
%outputimage%=@E, Output image,,^
%00image%=@E, Input image,,^
%constant%=@E, Constant,,
%gamma%=@E Gamma value,,
%maxvalue%=@E Maximum component value,,
%component%=@C Component,,RED,RED;GRN;BLU;ALL,'
%01redimage%=@E, Red image,,^
%02greenimage%=@E, Green image,,^
%03blueimage%=@E, Blue image,,^
%scale%=@E Scale value,,
%00pngfile%=@E PNG file name,,.png,,'
%011Dor2Darray%=@E 1D or 2D input array,,^
%022Darray%=@E 2D input array,,^
%03newmumrows%=@E New number of rows,,
%04newmumcolumns%=@E New number of columns,,
%01rgbinput%=@E RGB input image,,^
%02monochromeouput%=@E Monochrome output image,,^
%03channel%=@C Channel,,RED,RED;GRN;BLU,'
%01row%=@E Row,,
%02column%=@E Column,,
%04component%=@C Component,,RED,RED;GRN;BLU;LUM,'
%01fromimage%=@E From image,,^
%02toimage%=@E To image,,^
%012Doutarray%=@E 2D output array,,^
%01descriptorstring%=@E Descriptor string,,,,'
%01Xdetectorsize%=@E X detector size,,
%01Ydetectorsize%=@E Y detector size,, 
%01Xfieldoffset%=@E X field offset,,
%01Yfieldoffset%=@E Y field offset,,
%01fieldrotation%=@E Field rotation,,
%01imageunits%=@E Field units,,,,'
%01imagegri%=@E Image GRI,,
%01pixelsize%=@E Pixel size,,
%01imagesemidiagonal%=@E Image semi-diagonal,,
%01lensname%=@E Lens name,,,,'
%01imageNRD%=@E Image NRD,,
%01objectfilename%=@E Object file name,,,,'
%01objectsemidiagonal%=@E Object semi-diagonal,,
%01XnumPSFsamples%=@E Number of X PSF samples,,
%01YnumPSFsamples%=@E Number of Y PSF samples,,
%01simulationdate%=@E Simulation date,,,,'
%01symmetrytype%=@C Symmetry type,,NON,NON;ROT,'
%01imageTGR%=@E Image TGR,,
%01imagetitle%=@E Image title,,,,'
%05numwvl%=@E Number of wavelengths,,
%04pixelvalue%=@E Pixel value,,
%01storeimage%=@E Store into image,,^
%00imagefile%=@E Image file name,,,,'
%01imageextension%=@C File extension,,JPG,BMP;JPG;PNG;TIF,'

;; definition for plot functions
%plotfile%=@E Plot file,,
%plotcolor%=@C Plot color,,"0 !black","0 !black";"1 !red";"2 !green";"3 !blue";"4 !magenta";"5 !yellow";"6 !cyan";"7 !white";"8 !gray",
%01plotXposition%=@E X position,,
%02plotYposition%=@E Y position,,
%03plotcircleradius%=@E Radius,,
%plotlabeltext%=@E Label text,,
%01plotrectXdim%=@E X dimension,,
%02plotrectYdim%=@E Y dimension,,
%plotlabelsize%=@E Label size (inches),,
%plotdirection%=@E Direction (°),,
%01plotXshift%=@E X shift,,
%02plotXshift%=@E Y shift,,
%01plotscaleminX%=@E Minimum X value in plot,,
%02plotscalemaxX%=@E Maximum X value in plot,,
%03plotscaleminY%=@E Minimum Y value in plot,,
%04plotscalemaxY%=@E Maximum Y value in plot,,
%plottitle%=@E Plot title,,,,'
%plotscalevalue%=@E Axis scale value,,
%plotnumsteps%=@E Number of steps,,
%plotsymbol%=@E Symbol number (0 to 13),,

[HEADER | Insert header ]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! Macro:   %FullFileName% 
! Author:  %UserName% / %Company%
! Date:    %Date%
! Project: %1project%
! Comment: %2comment%
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
|
[CVMACRO | Insert a Code V macro ]
IN CV_MACRO:%cvmacro% |
[DIRECTORY | Insert current directory ]
%FilePath%|
[VARIABLE | Insert variable definition ]
%vartype% %varformat% %var% |
[ELSE | ELSE statement ]
ELSE 
	|
[ELSE IF | ELSE IF statement ]
ELSE IF %var% |
	
[FOR | FOR statement ]
FOR %var% |
	§
END FOR
[IF | IF statement ]
IF %var% |
	§
END IF
[UNTIL | UNTIL statement ]
UNTIL %var% |
	§
END UNTIL
[WHILE | WHILE statement ]
WHILE %var% |
	§
END WHILE
[GOTO | Go to  ]
GOTO %lbl% |
[LABEL | Label ]
LBL %lbl% |
[RETURN | Return ]
RTN 
[FUNCTION | Function definition ]
FCT @%func% |
	§
END FCT %retexpr%
[BUFFER | Output to buffer B0 ]
BUF
§|
BUF N
[COMMENT | Insert comment ]
! | 
[EVALUATE | Evaluate expression ]
EVA (|)
[SEPARATOR | Insert separator ]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! |
[NO ABORT | Ignore errors during macro execution ]
NAB
§|
NAB N
[FOCUS | Through focus settings ]
FFO %ffo%
NFO %nfo%
IFO %ifo%|
[PRIVATE | Private glass ]
PRV
	%01prvwvl% %02prvwavelengths%
	%03prvglassname% %04prvmlt% %05prvrefglass% %06prvdispersiontype% %07prvindicesorcoefs%
END
|
[PATH | Path definition ]
PTH %01pthfile% %02pthmode% %03pthpath% 
|
[COLOR | Choose color ]
%color%|
[OPE | Open file for data output ]
OPE %01opetype% U^%02opevariable% %03opefilename%.%04fileext%
§|
CLO U^%03opefilename%
[ABSF | Absolute value ]
ABSF(|)
[ACOSF | Arccosine (in radians) ]
ACOSF(|)
[AS_BUILT_VAR | AS-built performance ]
AS_BUILT_VAR(%zoompos%,%fieldnum%,%nrd%,%asbuilttype%)
[ASINF | Arcsine (in radians) ]
ASINF(|)
[ATANF | Arctangent (in radians) ]
ATANF(|)
[COSF | Cosine ]
COSF(|)
[DEG TO RAD | Degree to radian conversion ]
/180*^pi|
[EXPF | Exponential (e raised to power) ]
EXPF(|)
[GAUSSWTS | Gaussian quadrature coords & weights ]
GAUSSWTS(%numinputpts%, %inputcoord%, %inputwts%, %numquadpts%, %quadcoord%, %quadwts%)|
[LOGF | Natural logarithm ]
LOGF(|)
[LOG10F | Common logarithm ]
LOG10F(|)
[MAXF | Maximum value ]
MAXF(%expression1%, %expression2%)|
[MINF | Minimum value ]
MINF(%expression1%, %expression2%)|
[MODF | Modulo ]
MODF(%expression1%, %expression2%)|
[PI | PI definition ]
^pi == 3.14159265359
|
[RAD TO DEG | Radian to degree conversion ]
/^pi*180|
[RANDF | Random number (0,1) ]
RANDF|
[RMS_1FLD | RMS wfe for a single field ]
RMS_1FLD(%zoompos%, %fieldnum%, %wavenum%, %nrd%, %outputarray%, %focus%)|
[RMSSPOT | RMS spot size ]
RMSSPOT(%zoompos%, %fieldnum%, %defocusnumber%, %spoerrornrd%)|
[ROUNDF | Round to nearest whole number ]
ROUNDF(|)
[SIGNF | ABSF(expr1)*SIGN(expr2) ]
SIGNF(%expression1%, %expression2%)|
[SINF | Sine ]
SINF(|)
[SPOTDATA | Spot size calculations ]
SPOTDATA(%zoompos%, %fieldnum%, %defocusnumber%, %spoerrornrd%, %spotref%, %spotxoffset%, %spotyoffset%, %outputarray%)|
[SQRTF | Square root ]
SQRTF(|)
[TANF | Tangent ]
TANF(|)
[ZFRFIT | Fits user data to Fringe Zernike polynomials ]
ZFRFIT(%numpointsz%, %xarrz%, %yarrz%, %farrz%, %numtermsz%, %coefsz%)|
[ZRNFIT | Fits user data to standard Zernike polynomials ]
ZRNFIT(%numpointsz%, %xarrz%, %yarrz%, %farrz%, %numtermsz%, %coefsz%)|
[BESTSPH | Curvature of best fitting sphere ]
BESTSPH(%surfacenum%, %zoompos%, %minheight%, %maxheight%)|
[CNVTFIELD | Field convertion ]
CNVTFIELD(%fieldtype%)|
[GAUSSBEAM | Gaussian beam trace ]
GAUSSBEAM(%surfacenum%, %zoompos%, %fieldnum%, %wavenum%, %inputarray%, %outputgb%)|
[EVALZERN | Evaluates a Zernike polynomial ]
EVALZERN(%wavenum%, %fieldnum%, %zoompos%, %x%, %y%, %poltypeevalz%, %outputevalz%, %zerniketype%)|
[FITERROR | Returns the RMS fit error of a Zernike polynomial ]
FITERROR(%wavenum%, %fieldnum%, %zoompos%, %poltypeevalz%, %outputevalz%, %zerniketype%)|
[INDEX | Index of refraction in a gradient index glass ]
INDEX(%surfacenum%, %zoompos%, %wavenum%, %glassnum%, %x%, %y%, %z%)|
[MTF_1FLD | MTF of the lens system ]
MTF_1FLD(%zoompos%, %fieldnum%, %frequency%, %azimuth%, %nrd%, %outputarray%, %diforgeo%, %sinorsqw%)|
[NORMRADIUS | Normalization radius of a Zernike polynomial ]
NORMRADIUS(%wavenum%, %fieldnum%, %zoompos%, %poltypeevalz%, %outputevalz%, %zerniketype%)|
[POLGRID | Polarization properties of a grid of rays ]
POLGRID(%zoompos%, %wavenum%, %fieldnum%, %apercheck%, %nrd%, %inputarray%, %outputarray%)|
[RAYPOL | Fast ray trace to SI ]
RAYPOL(%zoompos%, %wavenum%, %apercheck%, %inputarray%, %outputarray%)|
[RAYRSI | Perform an RSI ray trace ]
RAYRSI(%zoompos%, %wavenum%, %fieldnum%, %refsurf%, %inputarray%)|
[RAYSIN | Perform a SIN ray trace ]
RAYSIN(%zoompos%, %wavenum%, %xtan%, %ytan%, %xdirtan%, %ydirtan%)|
[RAYTRA | Perform a SIN ray trace to SI ]
RAYTRA(%zoompos%, %wavenum%, %apercheck%, %inputarray%, %outputarray%)|
[RMSWE | RMS wavefront error information ]
RMSWE(%zoompos%, %wavenum%, %nrd%, %outputarray%, %focus%)|
[SAGF | Sag of the designated surface ]
SAGF(%surfacenum%, %zoompos%, %x%, %y%)|
[SASF | Compute surface astigmatism ]
SASF(%surfacenum%, %zoompos%, %x%, %y%, %outputarray%)|
[SURFSAGD | Variance of the sag ]
SURFSAGD(%surfacenum%, %zoompos%, %curvature%, %xinputarray%, %yinputarray%, %outputarray%)|
[SVD | Singular value decomposition ]
SVD(%A%, %arows%, %acols%, %U%, %V%, %S%)|
[TRA_1FLD | Average transmission and projected solid angle ]
TRA_1FLD(%zoompos%, %xfld%, %yfld%, %nrd%, %geoorstokes%, %gridscalefact%, %polinput%, %outputarray%)|
[TRANSFORM | Transformation of surface local coordinates ]
TRANSFORM(%surfacenum%, %refsurface%, %zoompos%, %transdata%)|
[ZERNIKE | Fringe or standard Zernike coefficient ]
ZERNIKE(%wavenum%, %fieldnum%, %zoompos%, %zcoefnum%, %nrd%, %numterms%, %pupilcoordtype%, %poltypeevalz%, %outputevalz%, %zerniketype%)|
[ZERNIKEGQ | Zernike coefficient using gaussian quadrature ]
ZERNIKEGQ(%wavenum%, %fieldnum%, %zoompos%, %zcoefnum%, %numterms%, %pupilcoordtype%, %poltypeevalz%, %outputevalz%, %zerniketype%)|
[ZFRCOEF | Fringe Zernike coefficient ]
ZFRCOEF(%wavenum%, %fieldnum%, %zoompos%, %zcoefnum%, %nrd%, %numterms%, %pupilcoordtype%)|
[ARR_TO_BUF | Copy array to buffer ]
ARR_TO_BUF(%inputarray%, %numrows%, %numcols%, %bufnum%)|
[BUF_TO_ARR | Copy buffer to array ]
BUF_TO_ARR(%bufnum%, %outputarray%, %startrow%, %endrow%, %startcol%, %endcol%)|
[FFTdDts | Fast Fourier Transform of array ]
FFT%dcomp%%tcomp%%scomp%(%cenin%, %cenout%, %fdata%, %numrows%, %numcols%, %fwd%)|
[GET_COMPLEX_MAGNITUDE | Magnitudes of complex array ]
GET_COMPLEX_MAGNITUDE(%comp%, %mag%, %nummags%)|
[GET_IMAGINARY_PART | Imaginary parts of complex array ]
GET_IMAGINARY_PART(%comp%, %imag%, %numimags%)|
[GET_REAL_PART | Real parts of complex array ]
GET_REAL_PART(%comp%, %real%, %numreals%)|
[PAD_REAL_TO_COMPLEX | Create complex array ]
PAD_REAL_TO_COMPLEX(%real%, %comp%, %numrealsconv%)|
[SCALE_REAL_ARRAY | Scale real array ]
SCALE_REAL_ARRAY(%real%, %scale%, %numvals%)|
[STDEV | Standard deviation of array ]
STDEV(%inputarray%, %numvals%)|
[SUMF | Sum of all elements ]
SUMF(%inputarray%, %numvals%)|
[CONCAT | Concatenates string 2 to string 1 ]
CONCAT(%stringexpr1%, %stringexpr2%)|
[LENSTR | Length of string in characters ]
LENSTR(%stringexpression%)|
[LOCSTR | Starting character position of substring in string ]
LOCSTR(%stringexpression%, %substringexpr%)|
[LOWCASE | Converts string to lower case ]
LOWCASE(%stringexpression%)|
[NUM_TO_STR | Converts value of expression to a string ]
NUM_TO_STR(%numexpression%)|
[RFSTR | Converts a replacement field entry to a string ]
RFSTR(%rfexpression%)|
[STR_TO_NUM | Converts first identifiable number in string to a number ]
STR_TO_NUM(%stringexpression%)|
[SUBSTR | Substring ]
SUBSTR(%stringexpression%, %begexpr%, %lengthexpr%)|
[TRUNC | Returns string with trailing blanks dropped ]
TRUNC(%stringexpression%)|
[UPCASE | Converts string to upper case ]
UPCASE(%stringexpression%)|
[EOFILE | TRUE if last READ operation encountered End of File ]
EOFILE
[CVERROR | Prints user-defined error message ]
CVERROR(%errormsg%, %contline%)|
[ISFCT | TRUE if named user-defined function exists ]
ISFCT (%fctname%)|
[ISLCL | TRUE if named local variable exists ]
ISLCL (%varname%)|
[ISGBL | TRUE if named global variable exists ]
ISGBL (%varname%)|
[ALI | Alignment optimization ]
ALI
	INT F| %aliint%.int 
	
GO
[ANA | First / Third order analysis ]
ANA
	THI F
	|
GO
[AUT | Automatic design ]
AUT
	|
	DRA SA
	MXC 25
	IMP 0.01
GO
[BEA | Gaussian beam trace ]
BEA
	WRX %beawrx%	
	WRY %beawry%|
GO
[BIO | Biocular display analysis ]
BIO
	NEL %01bionel%
	OFS %02bioofs%
	UNI %03biouni%
	|
GO
[BPR | Diffraction-based beam propagation ]
BPR
	WRX %beawrx%	
	WRY %beawrx%|	
GO
[CAM | Cam calculation ]
CAM
	NCS %01camncs%
	LIN |	! insert parameter values
	LLA %02camlla%
GO
[CAT | Catseye diagram ]
CAT
	SUR S%surfacenum%|
GO
[CEF | Coupling efficiency ]
CEF
	MPR %cefmpr% %cefr% %cefn% %cefa%|
GO
[COS | Cost analysis ]
COS
	BLD %01cosbld%
	SEP %02cossep%
	STE %03cosste%
	MAX %04cosmax%
	EDG %05cosedg%
	DTH %06cosdth%
GO
|
[CXP | CAD export ]
CXP
	TYP %cxptyp%
	FIL %cxpfil%|	
GO
[ELE | Element drawings ]
ELE
	NOT
	%elenot1%
	%elenot2%
	%elenot3%
	%elenot4%
	END|
GO
[ENV | Environmental analysis ]
ENV
	TEM %1envtem%
	%2envexp% %3envmat%
	%4envpre%	%5envgas%	%6envmmhg%|	
GO
[FAB | Fabrication data ]
FAB
	%01fabsag%%03fabsagsurf%
	%02fabbes%
	%04fabspa%
	%05fabgsc%
	%06fabdis% %07fabint% %08fabintfile%|
GO
[FIE | Field aberrations analysis ]
FIE
	%fielsa%
	%fieastchr%
	%fiedstchr%|
GO
[FMA | Field map ]
FMA
	FFD %fma01maptype% %fma02frequency%
	FCO %fma03fieldtype% %fma04circularfield%|	
GO
[FOO | Footprint analysis ]
FOO
	SUR S%surfacenum%
	NRD %foonrd%
	BOU %foobou%
	%foodap%|
GO
[FOV | Biocular field of view plot ]
FOV
	SSI %01fovssi%
	%02fovlis%|
GO
[GDE | Detector energy ]
GDE
	NRD %gdenrd%
	|
GO
[GHO | Ghost image analysis ]
GHO
	SUR S%ghofsurf%..%gholsurf%|
GO
[GLD | Glass catalog data ]
GLD
	%gldtype% %gldcat% %gldglass%|
GO
[GLS | Geometrical line spread function ]
GLS
	NRD %gdenrd%
	|
GO
[IMS | 2D image simulation ]
IMS
	OBJ %01imsobj%
	FCO %02imsfco%
	%03imsobh% %04imsobhval%
	XOF %05imsxof%
	YOF %06imsyof%
	AZI %07imsazi%
	TGR %08imstgr%
	PMX %09imspmx%
	PMY %10imspmy%
	SYM %11imssym%
	CME %12imscme%
	%13imssvi% %14imssvityp% %15imssvicol%
	|
GO
[LIB | Library maintenance ]
LIB
	TYP %libtype%
	%libdir% %libdirectory%
	%libpur%|
GO
[LSF | Line spread function ]
LSF
	PLO %01lsflis%
	TGR %02lsftgr%
	|
GO
[LTE | LIGHT TOOLS export ]
LTE
	FIL %ltename%|
GO
[LUM | Illumination analysis ]
LUM
	SHA %lum01sha% %lum02shadim%
	RCV %lum03rcv%
	RCG %lum04rcg%
	NRA %lum05nra%
	SYM %lum06sym%
	%lum07dis%
	%lum08rel%
	%lum09pro%
	%lum10clr%
	%lum11src%
	%lum12rap% %lum13raptype% %lum14rapfil%
	%lum15anp% %lum16anptype% %lum17anpfil%|
GO
[MTF | Modulation transfer function ]
MTF
	%mtffoc% %mtffre%|
GO
[MUL | Multilayer coating design & analysis ]
MUL
	MDA
		TIT %1multit%
		PHT %2mulpht%
		WL |		! wavelengths
		ANG			! angles
	
	MIC
		MWL			! wavelengths
		''			! material & n
		EXT '' 	! material & k
	END
	COA   '' 	! thickness ctrlcode material
	SUB ''		! substrate material	
	%3mulres% %4mulfres%
	MPL
		RFL			! or TRN
		RAN 0 1 0.05
		SPA 		! minwl maxwl step
	GO
	%5mulsav% %6mulfsav%
MEX
[NAR | Narcissus analysis ]
NAR
	CLD S%narsurf%|
GO
[PAR | Partial coherence ]
PAR
	RNA %parrna%
	BAR %parbarnum% %parbarwidth%|
GO
[PMA | Pupil map ]
PMA
	LIS %1pmalis%
	PLO %2pmaplo% 
	DIS %3pmadis%
	%4pmazernike% %5pmaznumterms%|
GO
[PSF | Point spread function ]
PSF
	LIS %1psflis%
	PLO %2psfplo% 
	DIS %3psfdis%|
GO
[QUA | Quadrant detector analysis ]
QUA
	NRD %gdenrd%
	|
GO
[RAD | Encircled energy ]
RAD
	NRD %gdenrd%
	%radcoo%|
GO
[RIM | Rimray aberration plot ]
RIM
	%rimwfr%|
GO
[SLD | Solid modelling ]
SLD
	SHA 1024
	SEC 270
	BAC 1 1 1|
GO
[SPE | Spectral analysis ]
SPE
	BLA %01spebla%
	RSP %02speresponse%
	%03spersp% %04speresponse%
	%05spersp% %06speresponse%
	%07spersp% %08speresponse%
	%09spersp% %10speresponse%
	%11spersp% %12speresponse%
	%13spersp% %14speresponse%
	%15spersp% %16speresponse%
	%17spersp% %18speresponse%
	%19spersp% %20speresponse%
GO|
[SPO | Spot diagram ]
SPO
	NRD %01sponrd%
	PAT %02spopat%
	%03spoair%
	ANN SPO %04spoannspo% 
	ANN RMS %05spoannrms%
	RTL %07sportlnrd% %06sportl%
	|
GO
[SSS | Solar simulator system ]
SSS
	LAM %1sssx% %1sssy%
	ARR %3sssusr% %4ssscha% %5sssxdec% %6sssydec% 
	SIM %7ssssim%
	%8sssplo%|
GO
[TES | Test plate fitting ]
TES
	IN %tesplaseq%.seq
	%tesstrategy%|
GO
[TOD | Distorsion tolerancing ]
TOD
	UNI %toduni%|
GO
[TOL | Primary aberration-based tolerancing ]
TOL
	%1toltab%
	%2toltab%
	%3toltab%
	%4tolfunc% %5tolperf%|
GO
[TOR | Wavefront differential tolerancing ]
TOR
	%1tortype%
	%2torfre% %3torfreq%|
GO
[TRA | Transmission analysis ]
TRA
	NRD %gdenrd%|
GO
[UGR | User-defined graphics ]
UGR
	TIT %1ugrtit%
	%2ugrtype%|
GO
[V3D | 3D view ]
V3D
	SUR S%01v3dsur%
	%02v3dcab%
	%03v3dfan% %04v3dfannumber%
	%05v3dgrd% %06v3dgrdx% %07v3dgrdy%
	|
GO
[VIE | View ]
VIE
	SUR S%01viesur%
	%02viefan%
	%03viecab%
	%04vienbr%
	%05viedum%
	%06vielco%
	|
GO
[WAV | Wavefront analysis ]
WAV
	%wavnom%
	%wavrfo%|
GO
[WEI | Weight analysis ]
WEI; GO|
[ALI_empty | Alignment optimization ]
ALI
	|
GO
[ANA_empty | First / Third order analysis ]
ANA
	|
GO
[AUT_empty | Automatic design ]
AUT
	|
GO
[BEA_empty | Gaussian beam trace ]
BEA
	|
GO
[BIO_empty | Biocular display analysis ]
BIO
	|
GO
[BPR_empty | Diffraction-based beam propagation ]
BPR
	|
GO
[CAM_empty | Cam calculation ]
CAM
	|
GO
[CAT_empty | Catseye diagram ]
CAT
	|
GO
[CEF_empty | Coupling efficiency ]
CEF
	|
GO
[COS_empty | Cost analysis ]
COS
	|
GO
[CXP_empty | CAD export ]
CXP
	|
GO
[ELE_empty | Element drawings ]
ELE
	|
GO
[ENV_empty | Environmental analysis ]
ENV
	|
GO
[FAB_empty | Fabrication data ]
FAB
	|
GO
[FIE_empty | Field aberrations analysis ]
FIE
	|
GO
[FMA_empty | Field map ]
FMA
	|
GO
[FOO_empty | Footprint analysis ]
FOO
	|
GO
[FOV_empty | Biocular field of view plot ]
FOV
	|
GO
[GDE_empty | Detector energy ]
GDE
	|
GO
[GHO_empty | Ghost image analysis ]
GHO
	|
GO
[GLD_empty | Glass catalog data ]
GLD
	|
GO
[GLS_empty | Geometrical line spread function ]
GLS
	|
GO
[IMS_empty | 2D image simulation ]
IMS
	|
GO
[LIB_empty | Library maintenance ]
LIB
	|
GO
[LSF_empty | Line spread function ]
LSF
	|
GO
[LTE_empty | LIGHT TOOLS export ]
LTE
	|
GO
[LUM_empty | Illumination analysis ]
LUM
	|
GO
[MTF_empty | Modulation transfer function ]
MTF
	|
GO
[MUL_empty | Multilayer coating design & analysis ]
MUL
	|
MEX
[NAR_empty | Narcissus analysis ]
NAR
	|
GO
[PAR_empty | Partial coherence ]
PAR
	|
GO
[PMA_empty | Pupil map ]
PMA
	|
GO
[PSF_empty | Point spread function ]
PSF
	|
GO
[QUA_empty | Quadrant detector analysis ]
QUA
	|
GO
[RAD_empty | Encircled energy ]
RAD
	|
GO
[RIM_empty | Rimray aberration plot ]
RIM
	|
GO
[SLD_empty | Solid modelling ]
SLD
	|
GO
[SPE_empty | Spectral analysis ]
SPE
	|
GO
[SPO_empty | Spot diagram ]
SPO
	|
GO
[TES_empty | Test plate fitting ]
TES
	|
GO
[TOD_empty | Distorsion tolerancing ]
TOD
	|
GO
[TOL_empty | Primary aberration-based tolerancing ]
TOL
	|
GO
[TOR_empty | Wavefront differential tolerancing ]
TOR
	|
GO
[TRA_empty | Transmission analysis ]
TRA
	|
GO
[UGR_empty | User-defined graphics ]
UGR
	|
GO
[V3D_empty | 3D view ]
V3D
	|
GO
[VIE_empty | View ]
VIE
	|
GO
[WAV_empty | Wavefront analysis ]
WAV
	|
GO
[ImageAdd | Image addition ]
ImageAdd(%imageA%, %imageB%, %outputimage%)|
[ImageAddConstantTo | Add constant to an image ]
ImageAddConstantTo(%00image%, %constant%)|
[ImageChangeGamma | Change gamma ]
ImageChangeGamma(%00image%, %gamma%)|
[ImageClip | Clip image ]
ImageClip(%00image%, %maxvalue%, %component%)|
[ImageCombineComponents | Combine RGB components ]
ImageCombineComponents(%01redimage%, %02greenimage%, %03blueimage%, %outputimage%)|
[ImageCopy | Copy an image ]
ImageCopy(%inputimage%, %outputimage%)|
[ImageDelete | Delete an image ]
ImageDelete(%00image%)|
[ImageDisplay | Display an image ]
ImageDisplay(%00image%, %scale%)|
[ImageExtractComponent | RGB channel extraction ]
ImageExtractComponent(%01rgbinput%, %02monochromeouput%, %03channel%)|
[ImageFlipX | Flip image around X ]
ImageFlipX(%00image%)|
[ImageFlipY | Flip image around Y ]
ImageFlipY(%00image%)|
[ImageFromArray | Convert 2D array to an image ]
ImageFromArray(%022Darray%, %02monochromeouput%)|
[ImageGetAverageValueColor | Compute average of each channel ]
ImageGetAverageValueColor(%00image%, %outputarray%)|
[ImageGetAverageValueMonochrome | Compute average of a monochrome image ]
ImageGetAverageValueMonochrome(%00image%)|
[ImageGetMaxValueColor | Compute max value of each channel ]
ImageGetMaxValueColor(%00image%, %outputarray%)|
[ImageGetMaxValueMonochrome | Compute max value of a monochrome image ]
ImageGetMaxValueMonochrome(%00image%)|
[ImageGetMinValueColor | Compute min value of each channel ]
ImageGetMinValueColor(%00image%, %outputarray%)|
[ImageGetMinValueMonochrome | Compute min value of a monochrome image ]
ImageGetMinValueMonochrome(%00image%)|
[ImageGetPixelAt | Value of a given pixel ]
ImageGetPixelAt(%00image%, %01row%, %02column%, %04component%)|
[ImageGetStatus | Status of previous image function call ]
ImageGetStatus|
[ImageGetSumOfValuesColor | Compute sum of each channel ]
ImageGetSumOfValuesColor(%00image%, %outputarray%)|
[ImageGetSumOfValuesMonochrome | Compute sum of a monochrome image ]
ImageGetSumOfValuesMonochrome(%00image%)|
[ImageMDCopy | Copy metadata ]
ImageMDCopy(%01fromimage%, %02toimage%)|
[ImageMDCopyWavelengthsAndWeights | Copy wavelengths and weights ]
ImageMDCopyWavelengthsAndWeights(%01fromimage%, %02toimage%)|
[ImageMDGetCME | Returns CME mode ]
ImageMDGetCME(%00image%)|
[ImageMDGetDescriptor | Return image descriptor ]
ImageMDGetDescriptor(%00image%)|
[ImageMDGetDEX | Return X detector size ]
ImageMDGetDEX(%00image%)|
[ImageMDGetDEY | Return Y detector size ]
ImageMDGetDEY(%00image%)|
[ImageMDGetFieldOffsetX | Return X object offset ]
ImageMDGetFieldOffsetX(%00image%)|
[ImageMDGetFieldOffsetY | Return Y object offset ]
ImageMDGetFieldOffsetY(%00image%)|
[ImageMDGetFieldRotation | Return object rotation ]
ImageMDGetFieldRotation(%00image%)|
[ImageMDGetFieldUnits | Return field units ]
ImageMDGetFieldUnits(%00image%)|
[ImageMDGetGamma | Return gamma value ]
ImageMDGetGamma(%00image%)|
[ImageMDGetGRI | Return GRI value ]
ImageMDGetGRI(%00image%)|
[ImageMDGetImagePixelSize | Return pixel size ]
ImageMDGetImagePixelSize(%00image%)|
[ImageMDGetImageSemiDiagonal | Retunrn image diagonal measurement ]
ImageMDGetImageSemiDiagonal(%00image%)|
[ImageMDGetLensName | Return lens name ]
ImageMDGetLensName(%00image%)|
[ImageMDGetNRD | Return NRD value ]
ImageMDGetNRD(%00image%)|
[ImageMDGetNumWavelengths | Return number of wavelengths ]
ImageMDGetNumWavelengths(%00image%, %04component%)|
[ImageMDGetNumXPixels | Return number of pixels in X direction ]
ImageMDGetNumXPixels(%00image%)|
[ImageMDGetNumYPixels | Return number of pixels in Y direction ]
ImageMDGetNumYPixels(%00image%)|
[ImageMDGetObjectFileName | Return object's file name ]
ImageMDGetObjectFileName(%00image%)|
[ImageMDGetObjectSemiDiagonal | Return object's half diagonal measurement ]
ImageMDGetObjectSemiDiagonal(%00image%)|
[ImageMDGetOffsetValue | Return offset value ]
ImageMDGetOffsetValue(%00image%)|
[ImageMDGetPMX | Return number of PSF sample in X direction ]
ImageMDGetPMX(%00image%)|
[ImageMDGetPMY | Return number of PSF sample in Y direction ]
ImageMDGetPMY(%00image%)|
[ImageMDGetScaleValue | Return scale for fitting 16-bit data to the dynamic range ]
ImageMDGetScaleValue(%00image%)|
[ImageMDGetSimulationDate | Return simulation date ]
ImageMDGetSimulationDate(%00image%)|
[ImageMDGetSym | Return symmetry type ]
ImageMDGetSym(%00image%)|
[ImageMDGetTGR | Return TGR value ]
ImageMDGetTGR(%00image%)|
[ImageMDGetTitle | Return title ]
ImageMDGetTitle(%00image%)|
[ImageMDGetWavelengthsAndWeights | Return wavelengths and weigths for 1 color ]
ImageMDGetWavelengthsAndWeights(%00image%, %012Doutarray%, %04component%)|
[ImageMDListHeaderInfo | Display header information ]
ImageMDListHeaderInfo(%00image%)|
[ImageMDSetDescriptor | Set descriptor ]
ImageMDSetDescriptor(%00image%, %01descriptorstring%)|
[ImageMDSetDEX | Set X detector size ]
ImageMDSetDEX(%00image%, %01Xdetectorsize%)|
[ImageMDSetDEY | Set Y detector size ]
ImageMDSetDEY(%00image%, %01Ydetectorsize%)|
[ImageMDSetFieldOffsetX | Set X field offset ]
ImageMDSetFieldOffsetX(%00image%, %01Xfieldoffset%)|
[ImageMDSetFieldOffsetY | Set Y field offset ]
ImageMDSetFieldOffsetY(%00image%, %01Yfieldoffset%)|
[ImageMDSetFieldRotation | Set field rotation ]
ImageMDSetFieldRotation(%00image%, %01fieldrotation%)|
[ImageMDSetFieldUnits | Set field units ]
ImageMDSetFieldUnits(%00image%, %01imageunits%)|
[ImageMDSetGRI | Set GRI ]
ImageMDSetGRI(%00image%, %01imagegri%)|
[ImageMDSetImagePixelSize | Set pixel size ]
ImageMDSetImagePixelSize(%00image%, %01pixelsize%)|
[ImageMDSetImageSemiDiagonal | Set image semi diagonal ]
ImageMDSetImageSemiDiagonal(%00image%, %01imagesemidiagonal%)|
[ImageMDSetLensName | Set lens name ]
ImageMDSetLensName(%00image%, %01lensname%)|
[ImageMDSetNRD | Set NRD ]
ImageMDSetNRD(%00image%, %01imageNRD%)|
[ImageMDSetObjectFileName | Set object file name ]
ImageMDSetObjectFileName(%00image%, %01objectfilename%)|
[ImageMDSetObjectSemiDiagonal | Set object semi diagonal ]
ImageMDSetObjectSemiDiagonal(%00image%, %01objectsemidiagonal%)|
[ImageMDSetPMX | Set number of X PSF samples ]
ImageMDSetPMX(%00image%, %01XnumPSFsamples%)|
[ImageMDSetPMY | Set number of Y PSF samples ]
ImageMDSetPMY(%00image%, %01YnumPSFsamples%)|
[ImageMDSetSimulationDate | Set simulation date ]
ImageMDSetSimulationDate(%00image%, %01simulationdate%)|
[ImageMDSetSym | Set symmetry type ]
ImageMDSetSym(%00image%, %01symmetrytype%)|
[ImageMDSetTGR | Change image TGR ]
ImageMDSetTGR(%00image%, %01imageTGR%)|
[ImageMDSetTitle | Change image title ]
ImageMDSetTitle(%00image%, %01imagetitle%)|
[ImageMDSetWavelengthsAndWeights |  ]
ImageMDSetWavelengthsAndWeights(%00image%, %022Darray%, %04component%, %05numwvl%)|
[ImageMultiplyByConstant | Multiply image by a constant ]
ImageMultiplyByConstant(%00image%, %constant%)|
[ImagePutPixelAt | Change pixel value ]
ImagePutPixelAt(%00image%, %01row%, %02column%, %03channel%, %04pixelvalue%)|
[ImageRead | Read a PNG image ]
ImageRead(%00pngfile%, %01storeimage%)|
[ImageRestoreFrom | Restore an image ]
ImageRestoreFrom(%00imagefile%, %01storeimage%)|
[ImageSaveAs | Save image ]
ImageSaveAs(%00image%, %00imagefile%, %01imageextension%)|
[ImageSubstract | Image substraction ]
ImageSubstract(%imageA%, %imageB%, %outputimage%)|
[ImageToArray | Convert an image to a 2D array ]
ImageToArray(%00image%, %012Doutarray%)|
[ImageWrite | Write a file to an image ]
ImageWrite(%00pngfile%, %00image%)|
[GetDim1Num | Number of elements (1D array) or number of rows (2D array) ]
GetDim1Num(%array%)
[GetDim2Num | Number of columns of a 1D array ]
GetDim2Num(%2Darray%)
[RedimNum | Change number of rows or colums in a 2D array ]
RedimNum(%022Darray%, %03newmumrows%, %04newmumcolumns%)
[Plot | Generalized plotting ]
PTH SEQ APP cv_macro:  
IN initplt 
$PLTFILE '%plotfile%'
|
$ENDPLT
DPL %plotfile%
[$CIRCLE | (Plot) Draw circle ]
$CIRCLE %01plotXposition% %02plotYposition% %03plotcircleradius%
|
[$COL | (Plot) Change color ]
$COL %plotcolor%
|
[$DRA | (Plot) Draw line ]
$DRA %01plotXposition% %02plotYposition%
|
[$ENDPLT | (Plot) Close plot file ]
$ENDPLT 
|
[$FRAME | (Plot) Code V frame ]
$FRAME %plottitle%
|
[$GLAB | (Plot) Write global label ]
$GLAB 
|
[$HISTSA | (Plot) Test of aberration histogram ]
$HISTSA %plotscalevalue%
|
[$LAB | (Plot) Write label ]
$LAB %plotlabeltext%
|
[$LDIR | (Plot) Direction ]
$LDIR %plotdirection%
|
[$LSIZ | (Plot) Label size ]
$LSIZ %plotlabelsize%
|
[$MOV | (Plot) Displacement ]
$MOV %01plotXposition% %02plotYposition%
|
[$PHELP | (Plot) Help for plot ]
$PHELP 
|
[$PLTFILE | (Plot) File ]
$PLTFILE '%plotfile%'
|
[$RDRA | (Plot) Draw line / relative ]
$RDRA %01plotXshift% %02plotXshift%
|
[$RECT | (Plot) Draw rectangle ]
$RECT %01plotrectXdim% %02plotrectYdim%
|
[$RMOV | (Plot) Relative displacement]
$RMOV %01plotXshift% %02plotXshift%
|
[$SAMPLE | (Plot) Plot sample ]
$SAMPLE %plotnumsteps%
|
[$SCALE | (Plot) Scale ]
$SCALE %01plotscaleminX% %02plotscalemaxX% %03plotscaleminY% %04plotscalemaxY%
|
[$SYM | (Plot) Draw symbol ]
$SYM %plotsymbol%
|